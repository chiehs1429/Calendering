<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CL / CT _ Inventory</title>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <script src='https://unpkg.com/tesseract.js@v2.1.0/dist/tesseract.min.js'></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        /* =========================================
           CSS 樣式設定 (美化版)
           ========================================= */
        * { box-sizing: border-box; }
        body { 
            font-family: 'Roboto', 'Segoe UI', Tahoma, Verdana, sans-serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 15px; 
            background-color: #1a1a1a; 
            color: #fff; 
        }
        
        /* 標題樣式 */
        h2 { 
            text-align: center; 
            margin: 10px 0 25px 0; 
            font-size: 2.2rem;       
            font-weight: 900;        
            letter-spacing: 1px;     
            text-transform: uppercase; 
            
            /* 漸層文字效果 */
            background: linear-gradient(90deg, #00c6ff 0%, #0072ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            
            /* 發光效果 */
            filter: drop-shadow(0 0 5px rgba(0, 198, 255, 0.5));
            
            /* 底部裝飾線 */
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        /* 人員代號輸入區 */
        .user-bar {
            display: flex; flex-wrap: wrap; align-items: center; gap: 10px; margin-bottom: 20px;
            background: #2c3e50; padding: 15px; border-radius: 12px; border: 1px solid #34495e;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .user-bar label { font-weight: bold; color: #5dade2; white-space: nowrap; font-size: 1rem; }
        .input-field {
            flex: 1; min-width: 100px; padding: 10px; border: 1px solid #555; border-radius: 8px;
            background: #fff; color: #000; font-size: 1.1rem; letter-spacing: 1px; font-weight: bold;
        }
        
        /* 模式切換按鈕 */
        .mode-switch { display: flex; gap: 10px; margin-bottom: 20px; }
        .mode-btn { 
            flex: 1; padding: 12px; border: none; border-radius: 12px; 
            background: #333; color: #aaa; font-weight: bold; cursor: pointer; transition: 0.3s; 
            display: flex; flex-direction: column; align-items: center; line-height: 1.2; font-size: 1rem;
            border: 1px solid #444;
        }
        .mode-btn small { font-size: 0.75rem; font-weight: normal; opacity: 0.8; margin-top: 3px;}
        .mode-btn.active { 
            background: linear-gradient(135deg, #007bff, #0056b3); 
            color: white; 
            box-shadow: 0 0 15px rgba(0,123,255,0.4); 
            border-color: #007bff;
            transform: translateY(-2px);
        }

        /* 視窗區域 */
        .viewport { 
            position: relative; 
            width: 100%; 
            height: 50vh; 
            background: #000; 
            border-radius: 16px; 
            overflow: hidden; 
            margin-bottom: 20px;
            border: 2px solid #444;
            cursor: pointer;
            -webkit-tap-highlight-color: transparent;
            z-index: 1;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #reader, #ocr-video { width: 100%; height: 100%; object-fit: cover; }
        #ocr-video { display: none; }

        .scan-guide-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; display: none; z-index: 10;
        }
        .guide-box {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 85%; 
            height: 70px;
            border: 2px solid #ff4d4d; 
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.75);
            border-radius: 12px;
            transition: 0.3s all;
        }
        .guide-box.ready { border-color: #00ff00; box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.85); }
        .guide-box.paused { border-color: #007bff; box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.6); }

        .guide-line {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 90%; 
            height: 2px; 
            background-color: rgba(255, 77, 77, 0.8); 
            transform: translate(-50%, -50%);
            pointer-events: none;
            transition: 0.3s all;
            box-shadow: 0 0 8px red;
        }
        .guide-box.ready .guide-line { background-color: #00ff00; box-shadow: 0 0 8px lime; }
        .guide-box.paused .guide-line { background-color: #007bff; }

        .guide-text {
            position: absolute; top: -45px; left: 0; width: 100%;
            text-align: center; color: #ff4d4d; font-size: 0.95rem; font-weight: bold;
            text-shadow: 1px 1px 2px black;
            transition: 0.3s all;
            background: rgba(0,0,0,0.7);
            padding: 6px 0;
            border-radius: 6px;
        }
        .guide-box.ready .guide-text { color: #00ff00; content: "✅ Ready"; }
        .guide-box.paused .guide-text { color: #007bff; }

        /* 功能按鈕區 */
        .controls { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px; }
        
        button.action-btn { 
            padding: 15px 5px; border: none; border-radius: 12px; cursor: pointer; 
            font-weight: bold; font-size: 0.9rem; color: white; transition: 0.2s;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            line-height: 1.4;
            position: relative;
            z-index: 100;
            width: 100%;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }
        button.action-btn:active { transform: scale(0.95); }
        button.action-btn small { font-size: 0.7rem; font-weight: normal; opacity: 0.9; margin-top: 3px; }

        .btn-clear { background: linear-gradient(145deg, #6c757d, #5a6268); } 
        .btn-flash { background: linear-gradient(145deg, #ffc107, #e0a800); color: #333 !important; }
        .btn-export { background: linear-gradient(145deg, #28a745, #218838); }
        .btn-settings { background: linear-gradient(145deg, #17a2b8, #138496); }
        .btn-upload { background: linear-gradient(145deg, #007bff, #0069d9); }
        .btn-sheet { background: linear-gradient(145deg, #6610f2, #520dc2); } 

        #loading-overlay {
            position: absolute; top: 0; left: 0; width: 100
